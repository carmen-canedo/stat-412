---
title: "Homework 2"
author: "Carmen Canedo"
date: "14 September 2020"
output: html_notebook
editor_options: 
  chunk_output_type: inline
---

# Libraries
Below are the libraries required to run this code.
```{r, message=FALSE}
library(tidyverse)
```

## Randomly generate three symbols
The following function generates three slot machine symbols:
  + DD - diamonds
  + 7 - sevens
  + BBB - triple bars
  + BB - double bars
  + B - single bars
  + C - cherries
  + 0 - zeroes
  
```{r}
# Function to get three random symbols
get_symbols <- function() {
  
  # Creating character vector containing symbol options
  wheel <- c("DD", "7", "BBB", "BB", "B", "C", "0")
  
  # Producing random sample of symbols, given specific probabilities
  wheel %>% 
    sample(size = 3, replace = TRUE,
           prob = c(0.03, 0.03, 0.06, 0.1, 0.25, 0.01, 0.52))
}
```

## Calculate score
```{r}
score <- function(symbols) {
  # Identifying the case
  same <- symbols[1] == symbols[2] && symbols[2] == symbols[3]
  bars <- symbols %in% c("B", "BB", "BBB")
  
  # Get prize
  if (same) {
    
    # Listing payouts
    payouts <- c("DD" = 100, "7" = 80, "BBB" = 40, "BB" = 25, "B" = 10, "C" = 10, "0" = 0)
    
    # Assigning prize from payouts vector
    prize <- unname(payouts[symbols[1]])
    
  } else if (all(bars)) {
    
    # Prize if all symbols are bars
    prize <- 5
    
  } else {
    # Counting number of cherries
    cherries <- sum(symbols =="C")
    
    # Assigning prize given number of cherries
    prize <- c(0, 2, 5)[cherries + 1]
    
  }
  
  # Adjust for diamonds
  diamonds <- sum(symbols == "DD")
  prize * 2 ^ diamonds
  
}
```


## Full slot machine
```{r}
play <- function() {
  
  # Generate symbols
  symbols <- get_symbols()
  
  # Display the symbols
  print(symbols)
  
  # Score the symbols
  score(symbols)
}
```

# Playing the slot machine
```{r}
play()

play()

play()
```

# Homework 2 Section
In this section, I am going to modify the play function and add a function that counts the number of turns before a player runs out of money.

## 1. Create `play2()`
`play2()` changes the probabilities of triple bars, zeroes, and cherries, and it adds the values for three single bars. In order to change the probabilities, we need to reassign them in `get_symbols()` above.
```{r}
# Function to get three random symbols
get_symbols <- function() {
  
  # Creating character vector containing symbol options
  wheel <- c("DD", "7", "BBB", "BB", "B", "C", "0")
  
  # Modifying probabilites for triple bars, zeroes, and cherries
  wheel %>% 
    sample(size = 3, replace = TRUE,
           prob = c(0.03, 0.03, 0.075, 0.1, 0.25, 0.015, 0.5))
}
```

Next, we are going to create a new function that returns the number of turns played before running out of money.
```{r}
number_of_turns <- function(initial_funds, cost, which_game) {
  funds <- seq(0, initial_funds)
  print("Your funds are:")
    for (i in funds) {
      if (initial_funds >= 0) {
        print(initial_funds)
        initial_funds <- initial_funds - cost
      }
    }
}
```

```{r}
number_of_turns(initial_funds = 100, cost = 25)
```


```{r}
play2 <- function() {
  
  # Generate symbols
  symbols <- get_symbols()
  
  # Display the symbols
  print(symbols)
  
  # Score the symbols
  score(symbols)
}
```


## 2. Create `number_of_turns()`

## 3. Which game allows for the most turns on average?

## 4. Supporting analysis for recommendation
Don't show code! (echo?)

## 5. Plot that compares the distribution of results from each game


